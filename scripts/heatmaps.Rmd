---
title: "heatmaps"
output: html_document
---
Rmd to make heatmaps for the crab project. Used normalized counts, then got variance stabililzed transformed values using `DESeq2`

### Set up R Markdown document
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Install/load packages:
(uncomment "install.packages("pheatmap")" if you need to install it)
```{r}
#install.packages("pheatmap")
library(pheatmap)
```

```{r}
library(dplyr)
library(DESeq2)
```

```{r}
#install.packages("RColorBrewer")
library(RColorBrewer)
```

# Read in normalized count data from individual samples:
```{r}
norm_counts <- read.delim("../data/salmon.isoform.TMM.EXPR.matrix")
head(norm_counts)
```
40,035 rows of normalized count data for 24 samples


Rename columns: 
```{r}
colnames(norm_counts) <- c("Trinity_ID", "CrabH_2", "CrabE_2", "CrabI_2", "CrabC_17", "CrabB_17", "CrabG_0", "CrabF_2", "CrabE_0", "CrabG_2", "CrabC_0", "CrabI_0", "CrabD_0", "CrabD_17", "CrabB_0", "CrabC_2", "CrabB_2", "CrabF_17", "CrabA_0", "CrabH_0", "CrabA_17", "CrabD_2", "CrabE_17", "CrabA_2", "CrabF_0")
head(norm_counts)
```


# Create heatmap of temperature DEG list 

Read in Temperature DEG list (423)
```{r}
temp_degs <- read.delim("../analyses/DEG-temperature.txt", header = TRUE)
head(temp_degs)
```

`join` with norm_counts by "Trinity_ID"
```{r}
temp_degs_counts <- left_join(norm_counts, temp_degs, by = "Trinity_ID")
head(temp_degs_counts)
```

Just want the ones that match! (list of 423)
```{r}
tempdegs_counts_match <- filter(temp_degs_counts, baseMean != "NA")
head(tempdegs_counts_match)
```
423 rows! Nice!

Create heatmap colors:
```{r}
heatmapReds <- RColorBrewer::brewer.pal(9, "Reds")
```

Pull out just the sample count data:
```{r}
tempdegs <- select(tempdegs_counts_match, Trinity_ID, CrabA_0, CrabA_2, CrabA_17, CrabB_0, CrabB_2, CrabB_17, CrabC_0, CrabC_2, CrabC_17, CrabD_0, CrabD_2, CrabD_17, CrabE_0, CrabE_2, CrabE_17, CrabF_0, CrabF_2, CrabF_17, CrabG_0, CrabG_2, CrabH_0, CrabH_2, CrabI_0, CrabI_2)
head(tempdegs)
```

Set Trinity_ID as row names:
```{r}
rownames(tempdegs) <- tempdegs$Trinity_ID #set Trinity IDs as rownames
tempdegs.heatmap <- tempdegs[,-1] #remove redundant column
head(tempdegs.heatmap)
```

Round up to integers
```{r}
tempdegs.heatmap <- round(tempdegs.heatmap,0)
head(tempdegs.heatmap)
```

```{r}
deseq2.colData <- data.frame(condition=factor(c(rep("CrabA", 3), rep("CrabB", 3), rep("CrabC", 3), rep("CrabD", 3), rep("CrabE", 3), rep("CrabF", 3), rep("CrabG", 2), rep("CrabH", 2), rep("CrabI", 2))), 
                             type=factor(rep("paired-end", 24)))
rownames(deseq2.colData) <- colnames(data)
deseq2.dds <- DESeqDataSetFromMatrix(countData = tempdegs.heatmap,
                                     colData = deseq2.colData, 
                                     design = ~ condition)
```

```{r}
deseq2.dds <- DESeq(deseq2.dds)
deseq2.res <- results(deseq2.dds)
deseq2.res <- deseq2.res[order(rownames(deseq2.res)), ]
```

```{r}
head(deseq2.res)
```

```{r}
# Count number of hits with adjusted p-value less then 0.05
dim(deseq2.res[!is.na(deseq2.res$padj) & deseq2.res$padj <= 0.05, ])
```


```{r}
#transform data (3 diff ways)
vsd <- varianceStabilizingTransformation(deseq2.dds, blind = TRUE)#variance stabilizing transoformation
rld <- rlog(deseq2.dds, blind = TRUE) #controls for rows with few counts
ntd <- normTransform(deseq2.dds) #transforms data for plotting
top10 <- order(rowMeans(counts(deseq2.dds, normalized = TRUE)),
               decreasing = TRUE)[1:10] #average counts for each gene and select top 20 most abundant genes
pheatmap(assay(ntd)[top10,], scale = "row", cluster_cols = FALSE)
```

```{r}
#pheatmap(tempdegs.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapReds, fontsize_col = 20, fontsize_row = 12)
```

# Create heatmap with infection DEG list
Just using crabs D (uninfected) and E (infected) across time


Read in Temperature DEG list (772)
```{r}
infection_degs <- read.delim("../analyses/DEG-infection.txt", header = TRUE)
head(infection_degs)
```

`join` with norm_counts by "Trinity_ID"
```{r}
infection_degs_counts <- left_join(norm_counts, infection_degs, by = "Trinity_ID")
head(infection_degs_counts)
```

Just want the ones that match! (list of 772)
```{r}
infectdegs_counts_match <- filter(infection_degs_counts, baseMean != "NA")
head(infectdegs_counts_match)
```
772! 

Pull out just the sample count data:
```{r}
infectiondegs <- select(infectdegs_counts_match, Trinity_ID, CrabD_0, CrabD_2, CrabD_17, CrabE_0, CrabE_2, CrabE_17)
head(infectiondegs)
```

Set Trinity_ID as row names:
```{r}
rownames(infectiondegs) <- infectiondegs$Trinity_ID #set Trinity IDs as rownames
infectiondegs.heatmap <- infectiondegs[,-1] #remove redundant column
head(infectiondegs.heatmap)
```

Round the data up to integers:

```{r}
infectiondegs.heatmap <- round(infectiondegs.heatmap,0)
head(infectiondegs.heatmap)
```


```{r}
deseq2.colData <- data.frame(condition=factor(c(rep("Uninfected", 3), rep("Infected", 3))), 
                             type=factor(rep("paired-end", 6)))
rownames(deseq2.colData) <- colnames(data)
deseq2.dds <- DESeqDataSetFromMatrix(countData = infectiondegs.heatmap,
                                     colData = deseq2.colData, 
                                     design = ~ condition)
```
```{r}
deseq2.dds <- DESeq(deseq2.dds)
deseq2.res <- results(deseq2.dds)
deseq2.res <- deseq2.res[order(rownames(deseq2.res)), ]
```
```{r}
head(deseq2.res)
```

```{r}
# Count number of hits with adjusted p-value less then 0.05
dim(deseq2.res[!is.na(deseq2.res$padj) & deseq2.res$padj <= 0.05, ])
```

```{r}
#transform data 
vsd <- varianceStabilizingTransformation(deseq2.dds, blind = FALSE)#variance stabilizing transoformation
rld <- rlog(deseq2.dds, blind = FALSE) #controls for rows with few counts
ntd <- normTransform(deseq2.dds) #transforms data for plotting
top10 <- order(rowMeans(counts(deseq2.dds, normalized = TRUE)),
               decreasing = TRUE)[1:10] #average counts for each gene and select top 20 most abundant genes
pheatmap(assay(ntd)[top10,], scale = "row", cluster_cols = FALSE)
```

```{r}
pheatmap(infectiondegs.heatmap, cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapReds, fontsize_col = 20, fontsize_row = 12)
```

# Create heatmap using the ABC GHI DEG list (5)

Read in ABC v GHI DEG list (5)
```{r}
ABCGHI_degs <- read.delim("../analyses/DEG-ABCGHI.txt", header = TRUE)
head(ABCGHI_degs)
```

`join` with norm_counts by "Trinity_ID"
```{r}
ABCGHI_degs_counts <- left_join(norm_counts, ABCGHI_degs, by = "Trinity_ID")
head(ABCGHI_degs_counts)
```

Just want the ones that match! (list of 5)
```{r}
ABCGHI_degs_counts_match <- filter(ABCGHI_degs_counts, baseMean != "NA")
head(ABCGHI_degs_counts_match)
```

Pull out just the sample count data:
```{r}
ABCGHIdegs <- select(ABCGHI_degs_counts_match, Trinity_ID, CrabA_0, CrabA_2, CrabB_0, CrabB_2, CrabC_0, CrabC_2, CrabG_0, CrabG_2, CrabH_0, CrabH_2, CrabI_0, CrabI_2)
head(ABCGHIdegs)
```

Set Trinity_ID as row names:
```{r}
rownames(ABCGHIdegs) <- ABCGHIdegs$Trinity_ID #set Trinity IDs as rownames
ABCGHIdegs.heatmap <- ABCGHIdegs[,-1] #remove redundant column
head(ABCGHIdegs.heatmap)
```

Round the data up to integers:

```{r}
ABCGHIdegs.heatmap <- round(ABCGHIdegs.heatmap,0)
head(ABCGHIdegs.heatmap)
```

`DESeq2` doesn't work on this data - too many zeros
```{r}
#deseq2.colData <- data.frame(condition=factor(c(rep("CrabA", 2), rep("CrabB", 2), rep("CrabC", 2), rep("CrabG", 2), rep("CrabH", 2), rep("CrabI", 2))), 
#                             type=factor(rep("paired-end", 12)))
#rownames(deseq2.colData) <- colnames(data)
#deseq2.dds <- DESeqDataSetFromMatrix(countData = ABCGHIdegs.heatmap,
#                                     colData = deseq2.colData, 
#                                     design = ~ condition)
```

```{r}
#deseq2.dds <- DESeq(deseq2.dds)
#deseq2.res <- results(deseq2.dds)
#deseq2.res <- deseq2.res[order(rownames(deseq2.res)), ]
```
Error - getting vst won't work for this dataset...     
Error in estimateSizeFactorsForMatrix(counts(object), locfunc = locfunc, : every gene contains at least one zero, cannot compute log geometric means 

```{r}
pheatmap(ABCGHIdegs.heatmap, cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapReds, fontsize_col = 20, fontsize_row = 12)
```

# Create heatmap using ABC v GHI DEG list (5) on all samples:

Just want the ones that match! (list of 5)
```{r}
ABCGHI_degs_counts_match <- filter(ABCGHI_degs_counts, baseMean != "NA")
head(ABCGHI_degs_counts_match)
```

Pull out sample columns:
```{r}
abcghidegs_allcrabs <- select(ABCGHI_degs_counts_match, Trinity_ID, CrabA_0, CrabA_2, CrabA_17, CrabB_0, CrabB_2, CrabB_17, CrabC_0, CrabC_2, CrabC_17, CrabD_0, CrabD_2, CrabD_17, CrabE_0, CrabE_2, CrabE_17, CrabF_0, CrabF_2, CrabF_17, CrabG_0, CrabG_2, CrabH_0, CrabH_2, CrabI_0, CrabI_2)
head(abcghidegs_allcrabs)
```


Set Trinity_ID as row names:
```{r}
rownames(abcghidegs_allcrabs) <- abcghidegs_allcrabs$Trinity_ID #set Trinity IDs as rownames
ABCGHIdegs_all.heatmap <- abcghidegs_allcrabs[,-1] #remove redundant column
head(ABCGHIdegs_all.heatmap)
```

Round the data up to integers:

```{r}
ABCGHIdegs_all.heatmap <- round(ABCGHIdegs_all.heatmap,0)
head(ABCGHIdegs_all.heatmap)
```

Transform data with `rlog` from `DESeq2`
```{r}


```


`DESeq2` doesn't work on this data - too many zeros 
```{r}
#deseq2.colData <- data.frame(condition=factor(c(rep("CrabA", 3), rep("CrabB", 3), rep("CrabC", 3), rep("CrabD", 3), rep("CrabE", 3), rep("CrabF", 3), rep("CrabG", 2), rep("CrabH", 2), rep("CrabI", 2))), 
#                             type=factor(rep("paired-end", 24)))
#rownames(deseq2.colData) <- colnames(data)
#deseq2.dds <- DESeqDataSetFromMatrix(countData = ABCGHIdegs_all.heatmap,
#                                     colData = deseq2.colData, 
#                                     design = ~ condition)
```

```{r}
#deseq2.dds <- DESeq(deseq2.dds)
#deseq2.res <- results(deseq2.dds)
#deseq2.res <- deseq2.res[order(rownames(deseq2.res)), ]
```
Error in estimateSizeFactorsForMatrix(counts(object), locfunc = locfunc, : every gene contains at least one zero, cannot compute log geometric means

Too many zeros... can't perform vst. 


```{r}
pheatmap(ABCGHIdegs_all.heatmap, cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapReds, fontsize_col = 20, fontsize_row = 12)
```

# NEW HEATMAP ATTEMPTS!!!! (CLEAR ENVIRONMENT BEFORE CONTINUING!)

Read in normalized counts: 
```{r}
norm_counts <- read.delim("../data/salmon.isoform.TMM.EXPR.matrix")
head(norm_counts)
```
40,035 rows of normalized count data for 24 samples


Rename columns: 
```{r}
colnames(norm_counts) <- c("Trinity_ID", "CrabH_2", "CrabE_2", "CrabI_2", "CrabC_17", "CrabB_17", "CrabG_0", "CrabF_2", "CrabE_0", "CrabG_2", "CrabC_0", "CrabI_0", "CrabD_0", "CrabD_17", "CrabB_0", "CrabC_2", "CrabB_2", "CrabF_17", "CrabA_0", "CrabH_0", "CrabA_17", "CrabD_2", "CrabE_17", "CrabA_2", "CrabF_0")
head(norm_counts)
```


## Heatmap of temperature DEG list across all samples
Read in Temperature DEG list (423)
```{r}
temp_degs <- read.delim("../analyses/DEG-temperature.txt", header = TRUE)
head(temp_degs)
```

`join` with norm_counts by "Trinity_ID"
```{r}
temp_degs_counts <- left_join(norm_counts, temp_degs, by = "Trinity_ID")
head(temp_degs_counts)
```

Just want the ones that match! (list of 423)
```{r}
tempdegs_counts_match <- filter(temp_degs_counts, baseMean != "NA")
head(tempdegs_counts_match)
```
Pull out just the sample count data:
```{r}
tempdegs <- select(tempdegs_counts_match, Trinity_ID, CrabA_0, CrabA_2, CrabA_17, CrabB_0, CrabB_2, CrabB_17, CrabC_0, CrabC_2, CrabC_17, CrabD_0, CrabD_2, CrabD_17, CrabE_0, CrabE_2, CrabE_17, CrabF_0, CrabF_2, CrabF_17, CrabG_0, CrabG_2, CrabH_0, CrabH_2, CrabI_0, CrabI_2)
head(tempdegs)
```

Set Trinity_ID as row names:
```{r}
rownames(tempdegs) <- tempdegs$Trinity_ID #set Trinity IDs as rownames
tempdegs.heatmap <- tempdegs[,-1] #remove redundant column
head(tempdegs.heatmap)
```

Create heatmap colors:
```{r}
heatmapReds <- RColorBrewer::brewer.pal(9, "Reds")
```

Going to remove all rows that have "0" for all samples: 
```{r}
noz_tempdegs.heatmap <- tempdegs.heatmap[rowSums(tempdegs.heatmap[, -1] >0) !=0, ]
head(noz_tempdegs.heatmap)
```
402 rows
 
```{r}
pheatmap(noz_tempdegs.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapReds, fontsize_col = 20, fontsize_row = 12)
```
Try with new color scheme so that value of 0 is white:
```{r}
heatmapRedBlue <- RColorBrewer::brewer.pal(11, "RdBu")
```

```{r}
pheatmap(noz_tempdegs.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 20, fontsize_row = 12)
```

```{r}
pheatmap(noz_tempdegs.heatmap, scale = "row", cluster_row = FALSE, cluster_cols = TRUE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 20, fontsize_row = 12)
```

## Create heatmap with infection DEG list
Just using crabs D (uninfected) and E (infected) across time

Read in Temperature DEG list (772)
```{r}
infection_degs <- read.delim("../analyses/DEG-infection.txt", header = TRUE)
head(infection_degs)
```

`join` with norm_counts by "Trinity_ID"
```{r}
infection_degs_counts <- left_join(norm_counts, infection_degs, by = "Trinity_ID")
head(infection_degs_counts)
```

Just want the ones that match! (list of 772)
```{r}
infectdegs_counts_match <- filter(infection_degs_counts, baseMean != "NA")
head(infectdegs_counts_match)
```

Pull out just the sample count data:
```{r}
infectiondegs <- select(infectdegs_counts_match, Trinity_ID, CrabD_0, CrabD_2, CrabD_17, CrabE_0, CrabE_2, CrabE_17)
head(infectiondegs)
```

Set Trinity_ID as row names:
```{r}
rownames(infectiondegs) <- infectiondegs$Trinity_ID #set Trinity IDs as rownames
infectiondegs.heatmap <- infectiondegs[,-1] #remove redundant column
head(infectiondegs.heatmap)
```

I think I should try to remove rows that have 0 all the way across:
```{r}
noz_infectiondegs.heatmap <- infectiondegs.heatmap[rowSums(infectiondegs.heatmap[, -1] >0) !=0, ]
head(noz_infectiondegs.heatmap)
```
now 144 rows! 

Woo! it worked. 
```{r}
pheatmap(noz_infectiondegs.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapReds, fontsize_col = 20, fontsize_row = 12)
```
Try with heatmap Red-blue (0 value = white)
```{r}
pheatmap(noz_infectiondegs.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 20, fontsize_row = 12)
```

```{r}
pheatmap(noz_infectiondegs.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = TRUE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 20, fontsize_row = 12)
```

```{r}
pheatmap(noz_infectiondegs.heatmap, scale = "row", cluster_row = FALSE, cluster_cols = TRUE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 20, fontsize_row = 12)
```
Crab E - infected 
Crab D - uninfected

### same thing but with more crabs comparing infection over time (will show effects of temperature on infection)
Pull out just the sample count data:
```{r}
infectiondegs_allcrabs <- select(infectdegs_counts_match, Trinity_ID, CrabA_0, CrabA_2, CrabA_17, CrabB_0, CrabB_2, CrabB_17, CrabC_0, CrabC_2, CrabC_17, CrabD_0, CrabD_2, CrabD_17, CrabE_0, CrabE_2, CrabE_17, CrabF_0, CrabF_2, CrabF_17, CrabG_0, CrabG_2, CrabH_0, CrabH_2, CrabI_0, CrabI_2)
head(infectiondegs_allcrabs)
```
Set Trinity_ID as row names:
```{r}
rownames(infectiondegs_allcrabs) <- infectiondegs_allcrabs$Trinity_ID #set Trinity IDs as rownames
infectiondegs_allcrabs.heatmap <- infectiondegs_allcrabs[,-1] #remove redundant column
head(infectiondegs_allcrabs.heatmap)
```

I think I should try to remove rows that have 0 all the way across:
```{r}
noz_infectiondegs_allcrabs.heatmap <- infectiondegs_allcrabs.heatmap[rowSums(infectiondegs_allcrabs.heatmap[, -1] >0) !=0, ]
head(noz_infectiondegs_allcrabs.heatmap)
```
447 rows:

```{r}
pheatmap(noz_infectiondegs_allcrabs.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 20, fontsize_row = 12)
```

### Try again with fewer samples
Pull out just the sample count data:
```{r}
infectiondegs_alltwodays <- select(infectdegs_counts_match, Trinity_ID, CrabA_0, CrabA_2, CrabB_0, CrabB_2, CrabC_0, CrabC_2, CrabD_0, CrabD_2, CrabE_0, CrabE_2, CrabF_0, CrabF_2, CrabG_0, CrabG_2, CrabH_0, CrabH_2, CrabI_0, CrabI_2)
head(infectiondegs_alltwodays)
```

Set Trinity_ID as row names:
```{r}
rownames(infectiondegs_alltwodays) <- infectiondegs_alltwodays$Trinity_ID #set Trinity IDs as rownames
infectiondegs_alltwodays.heatmap <-infectiondegs_alltwodays[,-1] #remove redundant column
head(infectiondegs_alltwodays.heatmap)
```

I think I should try to remove rows that have 0 all the way across:
```{r}
noz_infectiondegs_alltwodays.heatmap <- infectiondegs_alltwodays.heatmap[rowSums(infectiondegs_alltwodays.heatmap[, -1] >0) !=0, ]
head(noz_infectiondegs_alltwodays.heatmap)
```
349 rows

```{r}
pheatmap(noz_infectiondegs_alltwodays.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 20, fontsize_row = 12)
```

### Now just ABC and GHI and E (infected cold) at two time points: 

Pull out just the sample count data:
```{r}
infectiondegs_abceghitwodays <- select(infectdegs_counts_match, Trinity_ID, CrabA_0, CrabA_2, CrabB_0, CrabB_2, CrabC_0, CrabC_2, CrabE_0, CrabE_2, CrabG_0, CrabG_2, CrabH_0, CrabH_2, CrabI_0, CrabI_2)
head(infectiondegs_abceghitwodays)
```

Set Trinity_ID as row names:
```{r}
rownames(infectiondegs_abceghitwodays) <- infectiondegs_abceghitwodays$Trinity_ID #set Trinity IDs as rownames
infectiondegs_abceghitwodays.heatmap <-infectiondegs_abceghitwodays[,-1] #remove redundant column
head(infectiondegs_abceghitwodays.heatmap)
```


I think I should try to remove rows that have 0 all the way across:
```{r}
noz_infectiondegs_abceghitwodays.heatmap <- infectiondegs_abceghitwodays.heatmap[rowSums(infectiondegs_abceghitwodays.heatmap[, -1] >0) !=0, ]
head(noz_infectiondegs_abceghitwodays.heatmap)
```
345 rows

```{r}
pheatmap(noz_infectiondegs_abceghitwodays.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 20, fontsize_row = 12)
```

```{r}
pheatmap(noz_infectiondegs_abceghitwodays.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = TRUE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 20, fontsize_row = 12)
```

```{r}
pheatmap(noz_infectiondegs_abceghitwodays.heatmap, scale = "row", cluster_row = FALSE, cluster_cols = TRUE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 20, fontsize_row = 12)
```


Try same thing but with all day 0 on left, day 2 on right: 
Pull out just the sample count data:
```{r}
infectiondegs_abceghi_twodays <- select(infectdegs_counts_match, Trinity_ID, CrabA_0, CrabB_0, CrabC_0, CrabE_0, CrabG_0, CrabH_0, CrabI_0, CrabA_2, CrabB_2, CrabC_2, CrabE_2, CrabG_2, CrabH_2, CrabI_2)
head(infectiondegs_abceghi_twodays)
```

Set Trinity_ID as row names:
```{r}
rownames(infectiondegs_abceghi_twodays) <- infectiondegs_abceghi_twodays$Trinity_ID #set Trinity IDs as rownames
infectiondegs_abceghi_twodays.heatmap <-infectiondegs_abceghi_twodays[,-1] #remove redundant column
head(infectiondegs_abceghi_twodays.heatmap)
```

I think I should try to remove rows that have 0 all the way across:
```{r}
noz_infectiondegs_abceghi_twodays.heatmap <- infectiondegs_abceghi_twodays.heatmap[rowSums(infectiondegs_abceghi_twodays.heatmap[, -1] >0) !=0, ]
head(noz_infectiondegs_abceghi_twodays.heatmap)
```
345 rows

```{r}
pheatmap(noz_infectiondegs_abceghi_twodays.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 20, fontsize_row = 12)
```


## Create heatmap using ABC v GHI DEG list (5) on all samples:

Read in ABC v GHI DEG list (5)
```{r}
ABCGHI_degs <- read.delim("../analyses/DEG-ABCGHI.txt", header = TRUE)
head(ABCGHI_degs)
```

`join` with norm_counts by "Trinity_ID"
```{r}
ABCGHI_degs_counts <- left_join(norm_counts, ABCGHI_degs, by = "Trinity_ID")
head(ABCGHI_degs_counts)
```

Just want the ones that match! (list of 5)
```{r}
ABCGHI_degs_counts_match <- filter(ABCGHI_degs_counts, baseMean != "NA")
head(ABCGHI_degs_counts_match)
```

Pull out sample columns:
```{r}
abcghidegs_allcrabs <- select(ABCGHI_degs_counts_match, Trinity_ID, CrabA_0, CrabA_2, CrabA_17, CrabB_0, CrabB_2, CrabB_17, CrabC_0, CrabC_2, CrabC_17, CrabD_0, CrabD_2, CrabD_17, CrabE_0, CrabE_2, CrabE_17, CrabF_0, CrabF_2, CrabF_17, CrabG_0, CrabG_2, CrabH_0, CrabH_2, CrabI_0, CrabI_2)
head(abcghidegs_allcrabs)
```

Set Trinity_ID as row names:
```{r}
rownames(abcghidegs_allcrabs) <- abcghidegs_allcrabs$Trinity_ID #set Trinity IDs as rownames
ABCGHIdegs_all.heatmap <- abcghidegs_allcrabs[,-1] #remove redundant column
head(ABCGHIdegs_all.heatmap)
```
TRINITY_DN1994_c0_g2_i2 --> Mitochondrial import inner membrane translocase subunit Tim23	      
https://www.uniprot.org/uniprot/O14925      

TRINITY_DN3962_c0_g1_i7 --> Probable RNA-directed DNA polymerase from transposon BS (EC 2.7.7.49) (Reverse transcriptase)	      
https://www.uniprot.org/uniprot/Q95SX7        

TIRNITY_DN1456_c0_g1_i1 --> Huntingtin-interacting protein K (Huntingtin yeast partner K)        
https://pubmed.ncbi.nlm.nih.gov/27017930/         
Negative regulator of heat shock response        
https://www.uniprot.org/uniprot/Q9NX55        

TRINITY_DN365_c0_g1_i1 --> Breakpoint cluster region protein (EC 2.7.11.1)	Bcr Kiaa3017        
https://www.uniprot.org/uniprot/Q6PAJ1       

TRINITY_DN3830_c0_g1_i1 --> NO UNIPROT-SP-GO match


```{r}
pheatmap(ABCGHIdegs_all.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapReds, fontsize_col = 20, fontsize_row = 12)
```

Try with color scheme RedBlue (0 value = white)
```{r}
pheatmap(ABCGHIdegs_all.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 20, fontsize_row = 12)
```

```{r}
pheatmap(ABCGHIdegs_all.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = TRUE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 12, fontsize_row = 12)
```

# Same heatmap idea, but just for samples ABC and GHI across Day 0 and day 2:
```{r}
abcghidegs_twodays <- select(ABCGHI_degs_counts_match, Trinity_ID, CrabA_0, CrabA_2, CrabB_0, CrabB_2, CrabC_0, CrabC_2, CrabG_0, CrabG_2, CrabH_0, CrabH_2, CrabI_0, CrabI_2)
head(abcghidegs_twodays)
```

Set Trinity_ID as row names:
```{r}
rownames(abcghidegs_twodays) <- abcghidegs_twodays$Trinity_ID #set Trinity IDs as rownames
abcghidegs_twodays.heatmap <- abcghidegs_twodays[,-1] #remove redundant column
head(abcghidegs_twodays.heatmap)
```

```{r}
pheatmap(abcghidegs_twodays.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 20, fontsize_row = 12)
```

```{r}
pheatmap(abcghidegs_twodays.heatmap, scale = "row", cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = TRUE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRedBlue, fontsize_col = 20, fontsize_row = 12)
```

