---
title: "Gene expression heatmaps - practice"
output: html_document
---
Rmd to create heatmaps of differentially expressed gene lists. Two DEG lists (with gene counts):   
1. Temperature DEG and gene count list:
https://raw.githubusercontent.com/RobertsLab/paper-crab/master/analyses/temp_DEGlist-counts.tab 
2. Infection DEG and gene count list: https://raw.githubusercontent.com/RobertsLab/project-crab/master/analyses/2019-infection-degs_genecounts.csv 

ALSO --> after those two heatmaps, I'm making a TON of heatmaps from the 2020 Genewiz individual RNA seq data. 

### Set up R Markdown document

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Install packages:
(uncomment "install.packages("pheatmap")" if you need to install it)
```{r}
#install.packages("pheatmap")
library(pheatmap)
```

```{r}
library(dplyr)
```

```{r}
#install.packages("RColorBrewer")
library(RColorBrewer)
```

# Temperature comparison (elevated vs decreased) heatmap

Create color scheme and save as object:
(11 --> number of colors in color palette)
```{r}
heatmapRedYelBlu <- RColorBrewer::brewer.pal(11, "RdYlBu")
```

### Read in temperature DEG list with gene counts table (423 rows)
```{r}
temp_counts <- read.delim("../analyses/temp_DEGlist-counts-log.txt", sep = '\t')
head(temp_counts)
```

Subset just the Trinity_ID column and the gene count sample columns (log +1 transformed):
```{r}
matrix_temp <- select(temp_counts, Trinity_ID, X380822_cold_log, X380823_cold_log, X380824_warm_log, X380825_warm_log)
head(matrix_temp)
```

Set Trinity_ID as row names:
```{r}
rownames(matrix_temp) <- matrix_temp$Trinity_ID #set Trinity_ID as rownames
matrix_temp.heatmap <- matrix_temp[,-1] #remove redundant column
head(matrix_temp.heatmap)
```

Subset genes of interest (for practice, just picking random ones)
```{r}
#include_list <- c("TRINITY_DN169_c0_g1_i11", "TRINITY_DN983_c0_g1_i3", "TRINITY_DN25158_c34_g1_i1", "TRINITY_DN5806_c0_g1_i1")
#matrix_temp.heatmap.sub <- matrix_temp.heatmap[include_list, ]
#matrix_temp.heatmap.sub
```

Create heatmap for temperature subset DEG list:
```{r}
pheatmap(matrix_temp.heatmap, cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = FALSE, treeheight_col = 80, legend = TRUE, color = heatmapRedYelBlu, fontsize_col = 20, fontsize_row = 12)
```


# Infection comparison heatmap 

Heatmap color palette: 
```{r}
heatmapPiYG <- RColorBrewer::brewer.pal(11, "PiYG")
```

### Read in infection status DEG list with gene counts table (772 rows)
```{r}
infect_counts <- read.delim("../../project-crab/analyses/2019-infection-degs_genecounts.csv", sep = ',')
head(infect_counts)
```

Subset just the Trinity_ID column and the gene count sample columns:
```{r}
matrix_infect <- select(infect_counts, Trinity_ID, infected_12, uninfected_12, infected_26, uninfected_26)
head(matrix_infect)
```

Set Trinity_ID as row names:
```{r}
rownames(matrix_infect) <- matrix_infect$Trinity_ID #set Trinity_ID as rownames
matrix_infect.heatmap <- matrix_infect[,-1] #remove redundant column
head(matrix_infect.heatmap)
```

Subset genes of interest (for practice, just picking random ones)
```{r}
#include_list <- c("TRINITY_DN1003_c0_g1_i4", "TRINITY_DN7071_c0_g1_i1", "TRINITY_DN1796_c0_g1_i1", "TRINITY_DN1796_c0_g1_i1")
#matrix_infect.heatmap.sub <- matrix_infect.heatmap[include_list, ]
#matrix_infect.heatmap.sub
```

Create heatmap for temperature subset DEG list:
```{r}
pheatmap(matrix_infect.heatmap, cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = FALSE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapPiYG, fontsize_col = 20, fontsize_row = 12)
```

------------------------------------------------------------------------
# HEAT MAPS FOR INDIVIDUAL CRAB RNASEQ DATA
Just making a ton to see if anything is interesting 

upload individual RNAseq gene count data (2020 Genewiz samples): with log+1 transformation
```{r}
master_individual_counts <- read.delim("../analyses/individual-crab-isoform-counts-log.txt", sep = '\t')
head(master_individual_counts)
```

Pull out column Trinity IDs and all individual samples that have _log in column name: 
```{r}
matrix_individ_log <- select(master_individual_counts, X, X294_quant_log, X254_quant_log, X280_quant_log, X485_quant_log, X481_quant_log, X173_quant_log, X222_quant_log, X151_quant_log, X272_quant_log, X132_quant_log, X127_quant_log, X73_quant_log, X427_quant_log, X118_quant_log, X334_quant_log, X349_quant_log, X425_quant_log, X178_quant_log, X72_quant_log, X463_quant_log, X221_quant_log, X445_quant_log, X359_quant_log, X113_quant_log)
head(matrix_individ_log)
```

Rename columns based on crab ID along with sample day (example: A_0, A_2, A_17)
Tab 3 in this google doc give GeneWiz IDs for the individual crabs (A-I)
https://docs.google.com/spreadsheets/d/1d17yg5F5gKKC66O8QkTIlPxljJeuX7ZsG46pkBr1lNQ/edit#gid=848044428 

```{r}
colnames(matrix_individ_log) <- c("X", "CrabH_2", "CrabE_2", "CrabI_2", "CrabC_17", "CrabB_17", "CrabG_0", "CrabF_2", "CrabE_0", "CrabG_2", "CrabC_0", "CrabI_0", "CrabD_0", "CrabD_17", "CrabB_0", "CrabC_2", "CrabB_2", "CrabF_17", "CrabA_0", "CrabH_0", "CrabA_17", "CrabD_2", "CrabE_17", "CrabA_2", "CrabF_0")
head(matrix_individ_log)
```

# Heatmap for crabs A, B, and C over time
CrabA 0, 2, 17 (infected ambient)
CrabB 0, 2, 17 (infected ambient)
CrabC 0, 2, 17 (infected ambient)

Subset the Trinity IDs and the counts for those samples:
```{r}
ABC <- select(matrix_individ_log, X, CrabA_0, CrabA_2, CrabA_17, CrabB_0, CrabB_2, CrabB_17, CrabC_0, CrabC_2, CrabC_17)
head(ABC)
```

Set Trinity_ID as row names:
```{r}
rownames(ABC) <- ABC$X #set Trinity IDs as rownames
ABC.heatmap <- ABC[,-1] #remove redundant column
head(ABC.heatmap)
```

Create heatmap colors:
```{r}
heatmapPRGn <- RColorBrewer::brewer.pal(11, "PRGn")
```

Create heatmap for temperature subset DEG list:
24,727 rows ---> TOO MANY FOR ONE HEATMAP

Open the annotated version of the individual crab isoform matrix to find genes of interest (compared to list of stress response genes)
```{r}
annotated <- read.delim("../analyses/individual-crab-counts-annot.tab", sep = '\t')
head(annotated)
```

Subset some random genes (can pick some cool ones later): 
TRINITY_DN3510_c0_g1_i1 	DnaJ homolog subfamily B member 4 (protein folding [GO:0006457]; response to heat)

TRINITY_DN745_c3_g1_i2 proPO-A3 (defense response to fungus)

TRINITY_DN4425_c0_g1_i1	HSP 90-beta  

TRINITY_DN745_c3_g2_i2 proPO-A3 - defense response to fungus, bacteria, etc.; melanotic encapsulation of foreign target

TRINITY_DN3772_c0_g1_i1 Heat shock protein 75 kDa, mitochondrial (HSP 75) (TNFR-associated protein 1) 
```{r}
include_list <- c("TRINITY_DN3510_c0_g1_i1", "TRINITY_DN745_c3_g1_i2", "TRINITY_DN4425_c0_g1_i1", "TRINITY_DN745_c3_g2_i2", "TRINITY_DN3772_c0_g1_i1")
ABC.heatmap.sub <- ABC.heatmap[include_list, ]
ABC.heatmap.sub
```

```{r}
pheatmap(ABC.heatmap.sub, cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = TRUE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapPRGn, fontsize_col = 20, fontsize_row = 12)
``` 


# HEAT MAPS FOR COMPARING CRAB D AND E
Comparing D and E over time
Crab D --> uninfected, decreased temp
Crab E --> infected, decreased temp


```{r}
DE <- select(matrix_individ_log, X, CrabD_0, CrabD_2, CrabD_17, CrabE_0, CrabE_2, CrabE_17, CrabE_0, CrabE_2, CrabE_17)
head(DE)
```

Set Trinity_ID as row names:
```{r}
rownames(DE) <- DE$X #set Trinity IDs as rownames
DE.heatmap <- DE[,-1] #remove redundant column
head(DE.heatmap)
```

Create heatmap colors:
```{r}
heatmapRdBu <- RColorBrewer::brewer.pal(11, "RdBu")
```


```{r}
include_list <- c("TRINITY_DN3510_c0_g1_i1", "TRINITY_DN745_c3_g1_i2", "TRINITY_DN4425_c0_g1_i1", "TRINITY_DN745_c3_g2_i2", "TRINITY_DN3772_c0_g1_i1")
DE.heatmap.sub <- DE.heatmap[include_list, ]
DE.heatmap.sub
```

```{r}
pheatmap(DE.heatmap.sub, cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = TRUE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapRdBu, fontsize_col = 20, fontsize_row = 12)
``` 

# Heatmap for crabs G, H, and I across time
Crab G - infected elevated
Crab H - infected elevated
Crab I - infected elevated 

```{r}
GHI <- select(matrix_individ_log, X, CrabG_0, CrabG_2, CrabH_0, CrabH_2, CrabI_0, CrabI_2)
head(GHI)
```

Set Trinity_ID as row names:
```{r}
rownames(GHI) <- GHI$X #set Trinity IDs as rownames
GHI.heatmap <- GHI[,-1] #remove redundant column
head(GHI.heatmap)
```


Create heatmap colors:
```{r}
heatmapPuOr <- RColorBrewer::brewer.pal(11, "PuOr")
```


```{r}
include_list <- c("TRINITY_DN3510_c0_g1_i1", "TRINITY_DN745_c3_g1_i2", "TRINITY_DN4425_c0_g1_i1", "TRINITY_DN745_c3_g2_i2", "TRINITY_DN3772_c0_g1_i1")
GHI.heatmap.sub <- GHI.heatmap[include_list, ]
GHI.heatmap.sub
```

```{r}
pheatmap(GHI.heatmap.sub, cluster_row = TRUE, cluster_cols = FALSE, clustering_distance_rows = "euclidean", clustering_method = "average", show_rownames = TRUE, show_colnames = TRUE, treeheight_col = 80, legend = TRUE, color = heatmapPuOr, fontsize_col = 20, fontsize_row = 12)
```

# Heatmap for crabs A, E, and G across 2 time points 

# Heatmap for crabs A, E, and G at Day 2







